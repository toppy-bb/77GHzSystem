% 電気電子各種資料のためのタイトルマクロ
%	ver2.0: 19 Sep 1991 by shisei
% 	usage: \makedendentitle{左上文字列}{左下文字列}
%	\maketitle と大凡コンパチブルです。

% j-article.sty 用

% Fancyboxパッケージ利用タイトルマクロ
% 2000.5.13 改造   by T.M
% OPTION
% 指定なし：普通枠線
% shadow：影付き
% double：二重枠線
% oval：オーバルボックス（丸枠線）
% 同時に２つ以上のオプションを指定しないこと。
%
% 2010.05.29 modified by ishida
%       shadow, double, ovalのスペーシングを修正してOverfull \hboxを回避。

\RequirePackage{fancybox}

\newif\ifshadow
\newif\ifdouble
\newif\ifoval
\shadowfalse
\doublefalse
\ovalfalse


\DeclareOption{shadow}{
	\shadowtrue
}
\DeclareOption{double}{
	\doubletrue
}
\DeclareOption{oval}{
	\ovaltrue
}

\ProcessOptions


\def\makedendentitle#1#2{\par
 \begingroup
 \def\thefootnote{\fnsymbol{footnote}}
 \def\@makefnmark{\hbox 
 to 0pt{$^{\@thefnmark}$\hss}} 
 \if@twocolumn 			%@twocolumnという変数?が設定されているなら、
 \twocolumn[\@dendentitle{#1}{#2}]	%そうする。
 \else \newpage			%そうじゃないと、改頁して、
 \global\@topnum\z@ \@dendentitle{#1}{#2} \fi\thispagestyle{plain}\@thanks
 \endgroup
 \setcounter{footnote}{0}
 \let\makedendentitle\relax
 \let\@dendentitle\relax
 \gdef\@thanks{}\gdef\@author{}\gdef\@title{}\let\thanks\relax}

% タイトルの中身をいれたもの。
\def\@dendentitle#1#2{\newpage
 \null
%\vskip 2em
 \newlength \dendenwidth
 \dendenwidth = \textwidth
 \begin{center}


\ifshadow
        \advance\dendenwidth by -4\shadowsize
        \advance\dendenwidth by -\fboxrule
        \advance\dendenwidth by -\fboxsep
	\shadowbox{
		\parbox{\dendenwidth}
		{
			\vskip .5ex
			#1 \hfill \@date \\ 
			\parbox{\dendenwidth}{
			\vskip 1em
			%   \centering {\jLarge \dg \bf \@title \par} 
			\centering {\Large  \bf \@title \par} 
			\vskip 1em
			}
			\vskip 0ex 
			% なぜかこうするとうまくいく。
			#2 \hfill \@author 
			\vskip .5ex
		}
	}

\else
  \ifdouble
        \advance\dendenwidth by -4\fboxsep
        \advance\dendenwidth by -2\fboxrule
        \advance\dendenwidth by -1.5\fboxrule
        \advance\dendenwidth by -3\fboxrule
        \advance\dendenwidth by -3\fboxrule
        \advance\dendenwidth by -1pt
	\doublebox{
		\parbox{\dendenwidth}
		{
		\vskip .5ex
		#1 \hfill \@date \\ 
		\parbox{\dendenwidth}{
		\vskip 1em
		%  \centering {\jLarge \dg \bf \@title \par} 
		\centering {\Large  \bf \@title \par} 
		\vskip 1em
		}
		\vskip 0ex 
		% なぜかこうするとうまくいく。
		#2 \hfill \@author 
		\vskip .5ex
		}
	}


  \else
    \ifoval
                \advance\dendenwidth by -5\fboxsep
                \advance\dendenwidth by -2\fboxrule
		\ovalbox{
			\parbox{\dendenwidth}
			{
			\vskip .5ex
			#1 \hfill \@date \\ 
			\parbox{\dendenwidth}{
			\vskip 1em
			%  \centering {\jLarge \dg \bf \@title \par} 
			\centering {\Large  \bf \@title \par} 
			\vskip 1em
			}
			\vskip 0ex 
			% なぜかこうするとうまくいく。
			#2 \hfill \@author 
			\vskip .5ex
			}
		}


    \else
		\framebox[\textwidth]{
			\parbox{\dendenwidth}
			{
			\vskip .5ex
			#1 \hfill \@date \\ 
			\parbox{\dendenwidth}{
			\vskip 1em
			%  \centering {\jLarge \dg \bf \@title \par} 
			\centering {\Large  \bf \@title \par} 
			\vskip 1em
			}
			\vskip 0ex 
			% なぜかこうするとうまくいく。
			#2 \hfill \@author 
			\vskip .5ex
			}
		}

    \fi
  \fi
\fi


 \end{center}
% \vskip 3em
 \vskip 1em
}
